files <- list.files()
files <- files[grep(".csv", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "coma")
## load standard files
setwd(paste(work.dir))
files <- list.files()
files <- list.files()
files <- files[grep(".csv", files)]
## load standard files
setwd(paste(work.dir,"csv",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".csv", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "coma")
setwd(paste(work.dir,"csv",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".csv", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "coma")
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "tab")
setwd(paste(work.dir,"csv",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".csv", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "tab")
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "coma")
MMMregions <- int_nmr(spec,NMRmeth = "MMM-SSB")
View(MMMregions)
test <- unlist(MMMregions[[1]]$data$Integral)
test <- data.frame(unlist(MMMregions[[1]]$data$Integral))
View(test)
library(SOMnmR)
library(cmna)
library(minpack.lm)
library(quadprog)
library(SOMnmR)
library(pracma)
library(ggplot2)
work.dir <- c("N:/Documents/Data/carol_aldair/test_sample")
## load standard files
setwd(paste(work.dir,"csv",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".csv", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "coma")
MMMregions <- int_nmr(spec,NMRmeth = "MMM-SSB")
test <- data.frame(unlist(MMMregions[[1]]$data$Integral))
View(test)
library(SOMnmR)
work.dir <- c("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/")
## load standard files
setwd(paste(work.dir,"txt",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".txt", files)]
std_nmr("Terr")
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "Bruker")
ncdata <- mk_nc_data(spec)
# load nc data
setwd(paste(work.dir,"nc",sep = "/"))
ncdata <- nc_data("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/nc/NC_antartica.csv")
# Calculate Molecular mixing model NMR Meth either MMMFixN or MMM, ecosys either Terr or Aqua
setwd(paste(work.dir,sep = "/"))
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = TRUE)
library(cmna)
library(minpack.lm)
library(quadprog)
library(pracma)
library(ggplot2)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = TRUE)
write.csv(MMM, "MMM_R_Fix_2.csv")
MMM <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr", cndata = ncdata, cn_constrain = FALSE)
View(ncdata)
write.csv(MMM, "MMM_2.csv")
MMM <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr", cndata = ncdata, cn_constrain = FALSE)
ncdata[[1]]
ncdata[[1]]$name
ncdataa <- NULL
for (i in 1:length(MMMregions)) {
ncdat <- c(ncdata[[1]]$name,ncdata[[1]]$NC)
ncdataa <- rbind(ncdataa, ncdat)
}
ncdataa <- NULL
for (i in 1:length(ncdata)) {
ncdat <- c(ncdata[[1]]$name,ncdata[[1]]$NC)
ncdataa <- rbind(ncdataa, ncdat)
}
View(ncdataa)
ncdataa <- NULL
for (i in 1:length(ncdata)) {
ncdat <- c(ncdata[[i]]$name,ncdata[[i]]$NC)
ncdataa <- rbind(ncdataa, ncdat)
}
View(MMM)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = FALSE)
library(cmna)
library(minpack.lm)
library(quadprog)
library(SOMnmR)
library(pracma)
library(ggplot2)
## set working directory
# load devtools
library(devtools)
library(usethis)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = FALSE)
View(MMM)
library(SOMnmR)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = FALSE)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr", cndata = ncdata, cn_constrain = TRUE)
View(MMM)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terrmod", cndata = ncdata, cn_constrain = TRUE)
MMM <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terrmod", cndata = ncdata, cn_constrain = TRUE)
region_calc <- function (batch_nmr = NULL, file = NULL, NMRmeth = NULL, ecosys=NULL,
cn_constrain=FALSE, cndata = NULL) {
if (is.null(batch_nmr)) {
if (is.null(file)) {
stop("Please provide either a raw spectrum from the read_raw_spec function or a raw NMR file")
} else {
## read the raw spectra from a file list
batch.nmr <- read_raw_spec(file = file)
}
} else {
batch.nmr <- batch_nmr
}
if (is.null(NMRmeth)) {
## loop to process all samples
NMR.end <- NULL
batch.nmr <- int_nmr(batch.nmr)
for (i in 1:length(batch.nmr)) {
file.name <- batch.nmr[[i]]$name
Integral <- c(batch.nmr[[i]]$data$Integral)
##carboxyl C calculation
carboxyl <-  setNames(data.frame(sum(2*sum(Integral$normalized.Int[30:33]), sum(Integral$normalized.Int[21:24]), -sum(Integral$normalized.Int[3:6]))), c("Carboxyl"))
##Aryl C calculation
aryl <-  setNames(data.frame(sum(2*sum(Integral$normalized.Int[27:29]), sum(Integral$normalized.Int[18:20]), -sum(Integral$normalized.Int[1:2]))), c("Aryl"))
##O-Alkyl C calculation
oalkyl <-  setNames(data.frame(sum(2*sum(Integral$normalized.Int[4:8]), sum(Integral$normalized.Int[13:17]), -sum(Integral$normalized.Int[31:33]))), c("O-Alkyl"))
##Alkyl C calculation
alkyl <-  setNames(data.frame(sum(2*sum(Integral$normalized.Int[1:3]), sum(Integral$normalized.Int[10:12]), -sum(Integral$normalized.Int[28:30]))), c("Alkyl"))
##Put all together
#NMR.end[[i]] <- list(file.name = file.name, data = data.frame(carboxyl, aryl, oalkyl, alkyl))
NMR.end[[i]] <- data.frame(file.name, carboxyl, aryl, oalkyl, alkyl)
}
} else if (NMRmeth == "Bonanomi") {
## loop to process all samples
NMR.end <- NULL
for (i in 1:length(batch.nmr)) {
file.name <- batch.nmr[[i]]$name
sample <- list(batch.nmr[[i]])
Integral <- int_nmr (raw.spec = sample, NMRmeth = NMRmeth)
##carboxyl C calculation
carboxyl <-  setNames(data.frame(sum(2*sum(Integral[30:33,2]), sum(Integral[21:24,2]), -sum(Integral[3:6,2]))), c("Carboxyl"))
##Aryl C calculation
aryl <-  setNames(data.frame(sum(2*sum(Integral[27:29,2]), sum(Integral[18:20,2]), -sum(Integral[1:2,2]))), c("Aryl"))
##O-Alkyl C calculation
oalkyl <-  setNames(data.frame(sum(2*sum(Integral[4:8,2]), sum(Integral[13:17,2]), -sum(Integral[31:33,2]))), c("O-Alkyl"))
##Alkyl C calculation
alkyl <-  setNames(data.frame(sum(2*sum(Integral[1:3,2]), sum(Integral[10:12,2]), -sum(Integral[28:30,2]))), c("Alkyl"))
##Put all together
NMR.end[[i]] <- data.frame(file.name = file.name, data = data.frame(carboxyl, aryl, oalkyl, alkyl))
write.table(NMR.end[[i]], "output.csv", append = TRUE, sep = ",", dec = ".",
col.names = TRUE, row.names = FALSE)
sample <- NULL
}
} else if (NMRmeth == "MMM") {
## loop to process all samples
NMR.end <- NULL
raw.spec.end <- NULL
batch.nmr <- int_nmr(batch.nmr, NMRmeth = "MMM-SSB")
nmrmerge <- NULL
for (i in 1:length(batch.nmr)) {
raw.spec.end[[i]] <-  batch.nmr[[i]]
NCval <- as.numeric(cndata[[i]]$NC)
samplename <- batch.nmr[[i]]$name
sampleraw.spec <- batch.nmr[[i]]$data$raw.spec
sampleintegral <- as.data.frame(batch.nmr[[i]]$data$Integral)
Alkyl <- ifelse(sampleintegral$normalized.Int[4] - sampleintegral$normalized.Int[15] < 0,0, sampleintegral$normalized.Int[4] - sampleintegral$normalized.Int[15])
N_Alkyl_Methoxyl <- ifelse(sampleintegral$normalized.Int[5] < 0,0, sampleintegral$normalized.Int[5])
O_Alkyl <- ifelse(sampleintegral$normalized.Int[6] < 0,0, sampleintegral$normalized.Int[6])
Di_O_Alkyl <- ifelse(sampleintegral$normalized.Int[7] < 0,0, sampleintegral$normalized.Int[7] + sampleintegral$normalized.Int[1] + sampleintegral$normalized.Int[12])
Aromatic <- ifelse(sampleintegral$normalized.Int[8] < 0,0, sampleintegral$normalized.Int[8] + sampleintegral$normalized.Int[2] + sampleintegral$normalized.Int[13])
Phenolic <- ifelse(sampleintegral$normalized.Int[9] < 0,0, sampleintegral$normalized.Int[9] + sampleintegral$normalized.Int[3] + sampleintegral$normalized.Int[14])
Amide_Carboxylic <- ifelse(sampleintegral$normalized.Int[10] < 0,0, sampleintegral$normalized.Int[10] + sampleintegral$normalized.Int[3] + 2*sampleintegral$normalized.Int[15])
Ketone <- ifelse(sampleintegral$normalized.Int[11] < 0,0, sampleintegral$normalized.Int[11])
Amide_to_Ketone <- c(Amide_Carboxylic + Ketone)
sampleintegralend <- data.frame(Alkyl, N_Alkyl_Methoxyl, O_Alkyl, Di_O_Alkyl, Aromatic, Phenolic, Amide_to_Ketone)
sampleintegralend <- t(sampleintegralend)
sampleintegralend <- rbind(NCval,sampleintegralend)
raw.spec.end[[i]] <- list("name" = samplename, "data" = list("raw.spec" = sampleraw.spec,"Integral" = sampleintegralend))
if (ecosys == "Terr_Nelson") {
stdmat <- std_nmr(ecosys = "Terr_Nelson")
NMR.end <- fit_LCF(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30, NMRmeth = "MMM")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
} else if (ecosys == "Terr_Baldock") {
stdmat <- std_nmr(ecosys = "Terr_Baldock")
NMR.end <- fit_LCF(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30, NMRmeth = "MMM")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
} else if (ecosys == "Aqua_Nelson") {
stdmat <- std_nmr(ecosys = "Aqua_Nelson")
NMR.end <- fit_athena(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30,  NMRmeth = "MMM")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
}
}
## return the corrected spectra list
} else if (NMRmeth == "MMMFixN") {
## loop to process all samples
NMR.end <- NULL
raw.spec.end <- NULL
batch.nmr <- int_nmr(batch.nmr, NMRmeth = "MMM-SSB")
nmrmerge <- NULL
for (i in 1:length(batch.nmr)) {
raw.spec.end[[i]] <-  batch.nmr[[i]]
NCval <- as.numeric(cndata[[i]]$NC)
samplename <- batch.nmr[[i]]$name
sampleraw.spec <- batch.nmr[[i]]$data$raw.spec
sampleintegral <- as.data.frame(batch.nmr[[i]]$data$Integral)
Alkyl <- ifelse(sampleintegral$normalized.Int[4] - sampleintegral$normalized.Int[15] < 0,0, sampleintegral$normalized.Int[4] - sampleintegral$normalized.Int[15])
N_Alkyl_Methoxyl <- ifelse(sampleintegral$normalized.Int[5] < 0,0, sampleintegral$normalized.Int[5])
O_Alkyl <- ifelse(sampleintegral$normalized.Int[6] < 0,0, sampleintegral$normalized.Int[6])
Di_O_Alkyl <- ifelse(sampleintegral$normalized.Int[7] < 0,0, sampleintegral$normalized.Int[7] + sampleintegral$normalized.Int[1] + sampleintegral$normalized.Int[12])
Aromatic <- ifelse(sampleintegral$normalized.Int[8] < 0,0, sampleintegral$normalized.Int[8] + sampleintegral$normalized.Int[2] + sampleintegral$normalized.Int[13])
Phenolic <- ifelse(sampleintegral$normalized.Int[9] < 0,0, sampleintegral$normalized.Int[9] + sampleintegral$normalized.Int[3] + sampleintegral$normalized.Int[14])
Amide_Carboxylic <- ifelse(sampleintegral$normalized.Int[10] < 0,0, sampleintegral$normalized.Int[10] + sampleintegral$normalized.Int[3] + 2*sampleintegral$normalized.Int[15])
Ketone <- ifelse(sampleintegral$normalized.Int[11] < 0,0, sampleintegral$normalized.Int[11])
Amide_to_Ketone <- c(Amide_Carboxylic + Ketone)
sampleintegralend <- data.frame(Alkyl, N_Alkyl_Methoxyl, O_Alkyl, Di_O_Alkyl, Aromatic, Phenolic, Amide_to_Ketone)
sampleintegralend <- t(sampleintegralend)
sampleintegralend <- rbind(NCval,sampleintegralend)
raw.spec.end[[i]] <- list("name" = samplename, "data" = list("raw.spec" = sampleraw.spec,"Integral" = sampleintegralend))
if (ecosys == "Terr_Nelson") {
stdmat <- std_nmr(ecosys = "Terr_Nelson")
NMR.end <- fit_LCF(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30, NMRmeth = "MMMFixN")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
} else if (ecosys == "Terr_Baldock") {
stdmat <- std_nmr(ecosys = "Terr_Baldock")
NMR.end <- fit_athena(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30,  NMRmeth = "MMMFixN")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
} else if (ecosys == "Aqua_Nelson") {
stdmat <- std_nmr(ecosys = "Aqua_Nelson")
NMR.end <- fit_athena(all.samples = raw.spec.end, all.standards = stdmat, amoSTD = 6, best.fits = 30,  NMRmeth = "MMM")
## Elementar ratios (relative to C)
Cmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]+NMR.end$Protein*stdmat[[1]][9,1]+NMR.end$Lignin*stdmat[[1]][9,3]+
NMR.end$Lipid*stdmat[[1]][9,4]+NMR.end$Carbonyl*stdmat[[1]][9,5]+NMR.end$Char*stdmat[[1]][9,6])
Nmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]+NMR.end$Protein*stdmat[[1]][10,1]+NMR.end$Lignin*stdmat[[1]][10,3]+
NMR.end$Lipid*stdmat[[1]][10,4]+NMR.end$Carbonyl*stdmat[[1]][10,5]+NMR.end$Char*stdmat[[1]][10,6])
Hmol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]+NMR.end$Protein*stdmat[[1]][11,1]+NMR.end$Lignin*stdmat[[1]][11,3]+
NMR.end$Lipid*stdmat[[1]][11,4]+NMR.end$Carbonyl*stdmat[[1]][11,5]+NMR.end$Char*stdmat[[1]][11,6])
Omol <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]+NMR.end$Protein*stdmat[[1]][12,1]+NMR.end$Lignin*stdmat[[1]][12,3]+
NMR.end$Lipid*stdmat[[1]][12,4]+NMR.end$Carbonyl*stdmat[[1]][12,5]+NMR.end$Char*stdmat[[1]][12,6])
Cwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][9,2]*12.0107+NMR.end$Protein*stdmat[[1]][9,1]*12.0107+NMR.end$Lignin*stdmat[[1]][9,3]*12.0107+
NMR.end$Lipid*stdmat[[1]][9,4]*12.0107+NMR.end$Carbonyl*stdmat[[1]][9,5]*12.0107+NMR.end$Char*stdmat[[1]][9,6]*12.0107)
Nwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][10,2]*14.0067+NMR.end$Protein*stdmat[[1]][10,1]*14.0067+NMR.end$Lignin*stdmat[[1]][10,3]*14.0067+
NMR.end$Lipid*stdmat[[1]][10,4]*14.0067+NMR.end$Carbonyl*stdmat[[1]][10,5]*14.0067+NMR.end$Char*stdmat[[1]][10,6]*14.0067)
Hwgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][11,2]*1.00794+NMR.end$Protein*stdmat[[1]][11,1]*1.00794+NMR.end$Lignin*stdmat[[1]][11,3]*1.00794+
NMR.end$Lipid*stdmat[[1]][11,4]*1.00794+NMR.end$Carbonyl*stdmat[[1]][11,5]*1.00794+NMR.end$Char*stdmat[[1]][11,6]*1.00794)
Owgt <- as.numeric(NMR.end$Carbohydrates*stdmat[[1]][12,2]*15.994+NMR.end$Protein*stdmat[[1]][12,1]*15.994+NMR.end$Lignin*stdmat[[1]][12,3]*15.994+
NMR.end$Lipid*stdmat[[1]][12,4]*15.994+NMR.end$Carbonyl*stdmat[[1]][12,5]*15.994+NMR.end$Char*stdmat[[1]][12,6]*15.994)
swgt <- c(Cwgt + Nwgt + Hwgt +Owgt)
NOSC <- as.numeric(4+((2*Omol+3*Nmol-1*Hmol-4*Cmol)/Cmol))
## Final result
NMR.end <- cbind(NMR.end, Cmol, Nmol, Hmol, Omol, Cwgt/swgt, Nwgt/swgt, Hwgt/swgt, Owgt/swgt, NOSC)
}
}
}
#citation  <- setNames(data.frame(matrix(ncol = 1, nrow= nrow(NMR.end))), c("Plz cite this work as an incentive to its curation"))
#NMR.end <- cbind(NMR.end,citation)
return(NMR.end)
}
library(SOMnmR)
rm(region_calc())
rm(region_calc
)
library(SOMnmR)
library(cmna)
library(minpack.lm)
library(quadprog)
library(SOMnmR)
library(pracma)
library(ggplot2)
## load standard files
setwd(paste(work.dir,"txt",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".txt", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "Bruker")
work.dir <- c("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/")
## load standard files
setwd(paste(work.dir,"txt",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".txt", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "Bruker")
# load nc data
setwd(paste(work.dir,"nc",sep = "/"))
ncdata <- nc_data("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/nc/NC_antartica.csv")
# Calculate Molecular mixing model NMR Meth either MMMFixN or MMM, ecosys either Terr or Aqua
setwd(paste(work.dir,sep = "/"))
setwd(paste(work.dir,sep = "/"))
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_TB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata, cn_constrain = TRUE)
library(SOMnmR)
setwd(paste(work.dir,sep = "/"))
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_TB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_TN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Nelson", cndata = ncdata)
MMM_TB_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Baldock", cndata = ncdata)
MMM_AN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Aqua_Nelson", cndata = ncdata)
library(SOMnmR)
setwd(paste(work.dir,sep = "/"))
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_TB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_TN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Nelson", cndata = ncdata)
MMM_TB_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Baldock", cndata = ncdata)
MMM_AN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Aqua_Nelson", cndata = ncdata)
MMM_AB_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Aqua_Baldock", cndata = ncdata)
View(MMM_AB_fix)
write.csv(MMM_TN_fix, "MMM_TN_fix.csv")
write.csv(MMM_TB_fix, "MMM_TB_fix.csv")
write.csv(MMM_AN_fix, "MMM_AN_fix.csv")
write.csv(MMM_AB_fix, "MMM_AB_fix.csv")
library(SOMnmR)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata, cn_constrain = TRUE)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata, cn_constrain = TRUE)
write.csv(MMM_AN_fix, "MMM_AN_fix.csv")
write.csv(MMM_AB_fix, "MMM_AB_fix.csv")
View(MMM_AN_fix)
write.csv(MMM_TN_free, "MMM_TN_free.csv")
write.csv(MMM_TB_free, "MMM_TB_free.csv")
write.csv(MMM_AN_free, "MMM_AN_free.csv")
write.csv(MMM_AB_free, "MMM_AB_free.csv")
library(SOMnmR)
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
View(MMM_TN_fix)
MMM_TN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Nelson", cndata = ncdata)
View(MMM_TN_free)
library(SOMnmR)
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
View(MMM_TN_fix)
library(SOMnmR)
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata, cn_constrain = TRUE)
View(MMM_TN_fix)
MMM_TN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Nelson", cndata = ncdata)
View(MMM_TN_free)
library(SOMnmR)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata, cn_constrain = TRUE)
MMM_AN_fix <- region_calc(spec)
View(MMM_AN_fix)
MMM_AB_fix <- region_calc(spec, NMRmeth = "Bonannomi")
MMM_AB_fix <- region_calc(spec, NMRmeth = "Bonanomi")
warnings()
library(SOMnmR)
MMM_AB_fix <- region_calc(spec, NMRmeth = "Bonanomi")
library(SOMnmR)
library(cmna)
library(minpack.lm)
library(quadprog)
library(SOMnmR)
library(pracma)
library(ggplot2)
## load standard files
setwd(paste(work.dir,"txt",sep = "/"))
files <- list.files()
work.dir <- c("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/")
## load standard files
setwd(paste(work.dir,"txt",sep = "/"))
files <- list.files()
files <- list.files()
files <- files[grep(".txt", files)]
# types Bruker, "coma", "tab"
spec <- read_raw_spec(files, filetype = "Bruker")
# load nc data
setwd(paste(work.dir,"nc",sep = "/"))
ncdata <- nc_data("N:/Documents/Data/Luis_Almeida/Antartica/Paper_Antarctic/NMR/NMR_batch/nc/NC_antartica.csv")
# Calculate Molecular mixing model NMR Meth either MMMFixN or MMM, ecosys either Terr or Aqua
setwd(paste(work.dir,sep = "/"))
setwd(paste(work.dir,sep = "/"))
MMM_TN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Nelson", cndata = ncdata)
MMM_TB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Terr_Baldock", cndata = ncdata)
MMM_AN_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Nelson", cndata = ncdata)
MMM_AB_fix <- region_calc(spec, NMRmeth = "MMMFixN", ecosys= "Aqua_Baldock", cndata = ncdata)
MMM_TN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Nelson", cndata = ncdata)
MMM_TB_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Terr_Baldock", cndata = ncdata)
MMM_AN_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Aqua_Nelson", cndata = ncdata)
MMM_AB_free <- region_calc(spec, NMRmeth = "MMM", ecosys= "Aqua_Baldock", cndata = ncdata)
MMMregions <- int_nmr(spec, NMRmeth = "MMM-SSB", SSBcorr = TRUE)
MMMregions <- int_nmr(spec)
MMMregions_nc <- int_nmr(spec, NMRmeth = "MMM-SSB", SSBcorr = FALSE)
MMMregions_nc <- int_nmr(spec, NMRmeth = "MMM", SSBcorr = FALSE)
MMMregions_nc <- int_nmr(spec, NMRmeth = "MMM-SSB", SSBcorr = FALSE)
View(MMMregions)
MMMregions[[1]]$data$Integral
MMMregions_nc[[1]]$data$Integral
MMMregions <- int_nmr(spec, NMRmeth = "MMM-SSB", SSBcorr = TRUE)
MMMregions[[1]]$data$Integral
